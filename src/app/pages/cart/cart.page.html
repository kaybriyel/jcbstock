<ion-header #header class="ion-no-border fixed" style="background-color: #fff;">
  <ion-toolbar class="ion-padding">
    <ion-title *ngIf="!searchEnable" class="ion-no-padding">{{ noUnderscore(selectedSupplier ? selectedSupplier.name :
      '') || 'Cart'}}</ion-title>
    <ion-icon *ngIf="!searchEnable" slot="end" class="search-btn" name="search" (click)="toggleSearch()"></ion-icon>
    <ion-searchbar #searchBar *ngIf="searchEnable" [(ngModel)]="searchValue" [debounce]="250"></ion-searchbar>
    <ion-icon *ngIf="searchEnable" slot="end" class="close-btn" name="close" (click)="toggleSearch()"></ion-icon>
  </ion-toolbar>
  <ion-segment *ngIf="suppliers" value="{{selectedSupplier ? selectedSupplier.name : ''}}" scrollable="true"
    (ionChange)="segmentChanged($event)">
    <ion-segment-button *ngFor="let supplier of suppliers" value="{{supplier.name}}" (click)="scrollIntoView($event)">
      <ion-label>{{noUnderscore(supplier.name)}}</ion-label>
    </ion-segment-button>
  </ion-segment>
</ion-header>

<ion-content #content [scrollEvents]="true" (ionScrollStart)="scrollStart()" (ionScroll)="scrolling($event)"
  (ionScrollEnd)="scrollEnd()">
  <div style="height: 110px"></div>

  <ion-list *ngIf="list" class="ion-padding">
    <ion-list-header class="ion-no-padding" lines="none">
      <div style="width: 100%; display: flex; justify-content: space-between;">
        <h4>Count</h4>
        <h5>{{ filteredProducts.length }}</h5>
      </div>
    </ion-list-header>
    <ion-item-sliding class="product-card" *ngFor="let cart_item of filteredProducts">
      <ion-item button="true" lines="none" (click)="openProductDetailPage(cart_item.product)">
        <ion-thumbnail slot="start">
          <ion-img src="assets/pics/product.png"></ion-img>
        </ion-thumbnail>
        <ion-label class="ion-no-margin">
          <h2>{{ cart_item.product.name }}</h2>
          <p>
            <ion-text color="primary">{{ cart_item.formattedPrice }}</ion-text>
          </p>
          <p>
            <ion-text color="success">{{ cart_item.formattedAmount }}</ion-text>
          </p>
        </ion-label>
        <div slot="end" class="qty-wrapper">
          <div class="qty-btn-wrapper">
            <ion-button (click)="onClick()" shape="round" class="decrease" expand="full" size="small"><ion-icon name="remove"></ion-icon></ion-button>
            <ion-text>{{ cart_item.qty }}</ion-text>
            <ion-button (click)="onClick()" shape="round" class="increase" expand="full" size="small"><ion-icon name="add"></ion-icon></ion-button>
          </div>
          <ion-label class="label_unit">{{ cart_item.product.unit.symbol }}</ion-label>
        </div>
      </ion-item>
      <ion-item-options side="end">
        <ion-item-option class="delete" (click)="delete(cart_item.id)"><ion-icon name="trash-outline" size="large"></ion-icon></ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>

  <div style="height: 125px;"></div>

  <div #totalWrapper class="total-wrapper" slot="fixed" *ngIf="selectedSupplier"
    style="bottom: 0; width: 100%; padding: 16px 16px;background-color: #fff;">
    <ion-label style="margin-bottom: 4px;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
        <h3 style="font-size:large; font-weight: bold;">Total</h3>
        <h3 style="font-size:large; font-weight: bold;">{{ total }}</h3>
      </div>
    </ion-label>
    <ion-button style="height:60px; --border-radius: 16px;" shape="round" class="add_to_cart_btn" expand="full"
      color="success" (click)="proceedOrder()">
      Proceed To Order
    </ion-button>
  </div>

</ion-content>